{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.8.1", "generated_at": "2024-05-28T11:29:48.819388Z", "invocation_id": "4e9e7d62-5673-4862-a1ca-0cf0491c4cfa", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-28T11:29:18.510245Z", "completed_at": "2024-05-28T11:29:18.561921Z"}, {"name": "execute", "started_at": "2024-05-28T11:29:18.699958Z", "completed_at": "2024-05-28T11:29:21.441512Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 3.3107452392578125, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01b4a111-0000-b92c-0000-a0390003c032"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.dbtLego.missing_sets", "compiled": true, "compiled_code": "-- models/errors/missing_sets.sql\n\nWITH inventories AS (\n    SELECT\n        set_num\n    FROM lego_db.lego_schema.inventories\n),\nsets AS (\n    SELECT\n        set_num\n    FROM lego_db.lego_schema.sets\n)\n\nSELECT DISTINCT\n    i.set_num\nFROM inventories i\nLEFT JOIN sets s ON i.set_num = s.set_num\nWHERE s.set_num IS NULL", "relation_name": "lego_db.lego_schema.missing_sets"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-28T11:29:18.473961Z", "completed_at": "2024-05-28T11:29:18.549599Z"}, {"name": "execute", "started_at": "2024-05-28T11:29:18.693865Z", "completed_at": "2024-05-28T11:29:21.954695Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 3.8227553367614746, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01b4a111-0000-b8c5-0000-a0390003b0ba"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.dbtLego.inventories", "compiled": true, "compiled_code": "SELECT\n    id,\n    version,\n    set_num\nFROM lego_db.lego_schema.inventories", "relation_name": "lego_db.lego_schema.inventories"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-28T11:29:18.489520Z", "completed_at": "2024-05-28T11:29:18.545345Z"}, {"name": "execute", "started_at": "2024-05-28T11:29:18.623017Z", "completed_at": "2024-05-28T11:29:22.015359Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 3.9053051471710205, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01b4a111-0000-b8e4-0000-a03900038766"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.dbtLego.minifigs", "compiled": true, "compiled_code": "SELECT\n    fig_num,\n    name,\n    num_parts,\n    img_url\nFROM lego_db.lego_schema.minifigs", "relation_name": "lego_db.lego_schema.minifigs"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-28T11:29:18.429682Z", "completed_at": "2024-05-28T11:29:18.537182Z"}, {"name": "execute", "started_at": "2024-05-28T11:29:18.556765Z", "completed_at": "2024-05-28T11:29:21.998999Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 3.9233381748199463, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01b4a111-0000-b8e4-0000-a0390003876a"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.dbtLego.colors", "compiled": true, "compiled_code": "SELECT\n    id,\n    name,\n    rgb,\n    is_trans\nFROM lego_db.lego_schema.colors", "relation_name": "lego_db.lego_schema.colors"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-28T11:29:22.402536Z", "completed_at": "2024-05-28T11:29:22.422712Z"}, {"name": "execute", "started_at": "2024-05-28T11:29:22.425818Z", "completed_at": "2024-05-28T11:29:25.179046Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 3.1100854873657227, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01b4a111-0000-b92c-0000-a0390003c046"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.dbtLego.new_sets", "compiled": true, "compiled_code": "-- models/errors/new_sets.sql\n\nSELECT\n    m.set_num,\n    'Unknown' AS name,\n    NULL AS year,\n    NULL AS theme_id,\n    NULL AS num_parts,\n    NULL AS img_url\nFROM lego_db.lego_schema.missing_sets m", "relation_name": "lego_db.lego_schema.new_sets"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-28T11:29:21.747274Z", "completed_at": "2024-05-28T11:29:21.757236Z"}, {"name": "execute", "started_at": "2024-05-28T11:29:21.760237Z", "completed_at": "2024-05-28T11:29:25.707396Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 4.216509819030762, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01b4a111-0000-b92c-0000-a0390003c03e"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.dbtLego.part_categories", "compiled": true, "compiled_code": "SELECT\n    id,\n    name\nFROM lego_db.lego_schema.part_categories", "relation_name": "lego_db.lego_schema.part_categories"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-28T11:29:22.412595Z", "completed_at": "2024-05-28T11:29:22.423713Z"}, {"name": "execute", "started_at": "2024-05-28T11:29:22.435886Z", "completed_at": "2024-05-28T11:29:26.071558Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 3.955474615097046, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01b4a111-0000-b92c-0000-a0390003c042"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.dbtLego.inventory_minifigs", "compiled": true, "compiled_code": "SELECT\n    im.inventory_id,\n    im.fig_num,\n    im.quantity,\n    m.name AS minifig_name\nFROM lego_db.lego_schema.inventory_minifigs im\nLEFT JOIN lego_db.lego_schema.minifigs m ON im.fig_num = m.fig_num", "relation_name": "lego_db.lego_schema.inventory_minifigs"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-28T11:29:22.260385Z", "completed_at": "2024-05-28T11:29:22.330459Z"}, {"name": "execute", "started_at": "2024-05-28T11:29:22.334544Z", "completed_at": "2024-05-28T11:29:26.056566Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 4.1088972091674805, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01b4a111-0000-b8c5-0000-a0390003b0ca"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.dbtLego.themes", "compiled": true, "compiled_code": "WITH RECURSIVE theme_hierarchy AS (\n    SELECT\n        id,\n        name,\n        parent_id,\n        1 AS level\n    FROM lego_db.lego_schema.themes\n    WHERE parent_id IS NULL\n    UNION ALL\n    SELECT\n        t.id,\n        t.name,\n        t.parent_id,\n        th.level + 1\n    FROM lego_db.lego_schema.themes t\n    JOIN theme_hierarchy th ON t.parent_id = th.id\n)\nSELECT\n    id,\n    name,\n    parent_id,\n    level\nFROM theme_hierarchy", "relation_name": "lego_db.lego_schema.themes"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-28T11:29:26.397930Z", "completed_at": "2024-05-28T11:29:26.408924Z"}, {"name": "execute", "started_at": "2024-05-28T11:29:26.413921Z", "completed_at": "2024-05-28T11:29:29.491895Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 3.3404831886291504, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01b4a111-0000-b8c5-0000-a0390003b0de"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.dbtLego.total_minifigs_per_inventory", "compiled": true, "compiled_code": "-- models/aggregations/total_minifigs_per_inventory.sql\nSELECT\n    inventory_id,\n    SUM(quantity) AS total_minifigs\nFROM lego_db.lego_schema.inventory_minifigs\nGROUP BY inventory_id", "relation_name": "lego_db.lego_schema.total_minifigs_per_inventory"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-28T11:29:25.535496Z", "completed_at": "2024-05-28T11:29:25.606454Z"}, {"name": "execute", "started_at": "2024-05-28T11:29:25.612450Z", "completed_at": "2024-05-28T11:29:29.505984Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 4.2199084758758545, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01b4a111-0000-b8e4-0000-a03900038786"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.dbtLego.minifig_distribution_by_parts", "compiled": true, "compiled_code": "-- models/analysis/minifig_distribution_by_parts.sql\n\nSELECT\n    num_parts,\n    COUNT(*) AS num_minifigs\nFROM\n    lego_db.lego_schema.minifigs\nGROUP BY\n    num_parts\nORDER BY\n    num_parts", "relation_name": "lego_db.lego_schema.minifig_distribution_by_parts"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-28T11:29:26.499083Z", "completed_at": "2024-05-28T11:29:26.514706Z"}, {"name": "execute", "started_at": "2024-05-28T11:29:26.514706Z", "completed_at": "2024-05-28T11:29:30.297353Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 4.0518798828125, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01b4a111-0000-b92c-0000-a0390003c05a"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.dbtLego.sets", "compiled": true, "compiled_code": "SELECT\n    s.set_num,\n    s.name,\n    s.year,\n    s.theme_id,\n    s.num_parts,\n    s.img_url,\n    t.name AS theme_name\nFROM lego_db.lego_schema.sets s\nLEFT JOIN lego_db.lego_schema.themes t ON s.theme_id = t.id", "relation_name": "lego_db.lego_schema.sets"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-28T11:29:25.985652Z", "completed_at": "2024-05-28T11:29:25.995646Z"}, {"name": "execute", "started_at": "2024-05-28T11:29:25.997646Z", "completed_at": "2024-05-28T11:29:30.495785Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 4.832947731018066, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01b4a111-0000-b92c-0000-a0390003c056"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.dbtLego.parts", "compiled": true, "compiled_code": "SELECT\n    p.part_num,\n    p.name,\n    p.part_cat_id,\n    p.part_material,\n    pc.name AS category_name\nFROM lego_db.lego_schema.parts p\nLEFT JOIN lego_db.lego_schema.part_categories pc ON p.part_cat_id = pc.id", "relation_name": "lego_db.lego_schema.parts"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-28T11:29:30.593727Z", "completed_at": "2024-05-28T11:29:30.638701Z"}, {"name": "execute", "started_at": "2024-05-28T11:29:30.649694Z", "completed_at": "2024-05-28T11:29:33.487876Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 3.192908763885498, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01b4a111-0000-b92c-0000-a0390003c062"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.dbtLego.avg_parts_per_set_by_year", "compiled": true, "compiled_code": "-- models/analysis/avg_parts_per_set_by_year.sql\n\nSELECT\n    year,\n    AVG(num_parts) AS avg_num_parts\nFROM\n    lego_db.lego_schema.sets\nGROUP BY\n    year\nORDER BY\n    year", "relation_name": "lego_db.lego_schema.avg_parts_per_set_by_year"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-28T11:29:30.625715Z", "completed_at": "2024-05-28T11:29:30.664687Z"}, {"name": "execute", "started_at": "2024-05-28T11:29:30.681681Z", "completed_at": "2024-05-28T11:29:33.562833Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 3.204893112182617, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01b4a111-0000-b8c5-0000-a0390003b0ee"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.dbtLego.sets_by_year", "compiled": true, "compiled_code": "-- models/analysis/sets_by_year.sql\n\nSELECT\n    year,\n    COUNT(*) AS num_sets\nFROM\n    lego_db.lego_schema.sets\nGROUP BY\n    year\nORDER BY\n    year", "relation_name": "lego_db.lego_schema.sets_by_year"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-28T11:29:30.831589Z", "completed_at": "2024-05-28T11:29:30.904548Z"}, {"name": "execute", "started_at": "2024-05-28T11:29:30.915542Z", "completed_at": "2024-05-28T11:29:34.003200Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 3.409839153289795, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01b4a111-0000-b8e4-0000-a03900038792"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.dbtLego.sets_with_most_minifigs", "compiled": true, "compiled_code": "-- models/analysis/sets_with_most_minifigs.sql\n\nSELECT \n    s.set_num, \n    s.name, \n    SUM(im.quantity) AS total_minifigs \nFROM \n    lego_db.lego_schema.inventory_minifigs AS im\nJOIN \n    lego_db.lego_schema.inventories AS i ON im.inventory_id = i.id \nJOIN \n    lego_db.lego_schema.sets AS s ON i.set_num = s.set_num \nGROUP BY \n    s.set_num, \n    s.name \nORDER BY \n    total_minifigs DESC \nLIMIT 10", "relation_name": "lego_db.lego_schema.sets_with_most_minifigs"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-28T11:29:30.606744Z", "completed_at": "2024-05-28T11:29:30.645697Z"}, {"name": "execute", "started_at": "2024-05-28T11:29:30.667684Z", "completed_at": "2024-05-28T11:29:34.067529Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 3.73575496673584, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01b4a111-0000-b92c-0000-a0390003c066"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.dbtLego.inventory_sets", "compiled": true, "compiled_code": "SELECT\n    i.inventory_id,\n    i.set_num,\n    i.quantity,\n    s.name AS set_name\nFROM lego_db.lego_schema.inventory_sets i\nLEFT JOIN lego_db.lego_schema.sets s ON i.set_num = s.set_num", "relation_name": "lego_db.lego_schema.inventory_sets"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-28T11:29:33.774926Z", "completed_at": "2024-05-28T11:29:33.786921Z"}, {"name": "execute", "started_at": "2024-05-28T11:29:33.792916Z", "completed_at": "2024-05-28T11:29:36.554565Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 3.035493850708008, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01b4a111-0000-b8c5-0000-a0390003b0fa"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.dbtLego.theme_popularity_over_time", "compiled": true, "compiled_code": "-- models/analysis/theme_popularity_over_time.sql\n\nSELECT\n    t.name AS theme_name,\n    s.year,\n    COUNT(*) AS num_sets\nFROM\n    lego_db.lego_schema.themes AS t\nJOIN\n    lego_db.lego_schema.sets AS s ON t.id = s.theme_id\nGROUP BY\n    t.name,\n    s.year\nORDER BY\n    s.year,\n    num_sets DESC", "relation_name": "lego_db.lego_schema.theme_popularity_over_time"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-28T11:29:34.438712Z", "completed_at": "2024-05-28T11:29:34.477690Z"}, {"name": "execute", "started_at": "2024-05-28T11:29:34.479690Z", "completed_at": "2024-05-28T11:29:37.216286Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 3.0229578018188477, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01b4a111-0000-b8e4-0000-a03900038796"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.dbtLego.part_categories_with_most_parts", "compiled": true, "compiled_code": "-- models/analysis/part_categories_with_most_parts.sql\n\nSELECT\n    pc.name AS category_name,\n    COUNT(p.part_num) AS num_parts\nFROM\n    lego_db.lego_schema.part_categories AS pc\nJOIN\n    lego_db.lego_schema.parts AS p ON pc.id = p.part_cat_id\nGROUP BY\n    pc.name\nORDER BY\n    num_parts DESC\nLIMIT 10", "relation_name": "lego_db.lego_schema.part_categories_with_most_parts"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-28T11:29:33.825897Z", "completed_at": "2024-05-28T11:29:33.845888Z"}, {"name": "execute", "started_at": "2024-05-28T11:29:33.847884Z", "completed_at": "2024-05-28T11:29:37.491653Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 3.9226255416870117, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01b4a111-0000-b8c5-0000-a0390003b0fe"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.dbtLego.elements", "compiled": true, "compiled_code": "SELECT\n    e.element_id,\n    e.part_num,\n    p.name AS part_name,\n    e.color_id,\n    c.name AS color_name,\n    e.design_id\nFROM lego_db.lego_schema.elements e\nLEFT JOIN lego_db.lego_schema.parts p ON e.part_num = p.part_num\nLEFT JOIN lego_db.lego_schema.colors c ON e.color_id = c.id", "relation_name": "lego_db.lego_schema.elements"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-28T11:29:36.821412Z", "completed_at": "2024-05-28T11:29:36.834406Z"}, {"name": "execute", "started_at": "2024-05-28T11:29:36.835405Z", "completed_at": "2024-05-28T11:29:39.444774Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 2.85095477104187, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01b4a111-0000-b8c5-0000-a0390003b102"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.dbtLego.part_relationships", "compiled": true, "compiled_code": "SELECT\n    pr.rel_type,\n    pr.child_part_num,\n    cp.name AS child_part_name,\n    pr.parent_part_num,\n    pp.name AS parent_part_name\nFROM lego_db.lego_schema.part_relationships pr\nLEFT JOIN lego_db.lego_schema.parts cp ON pr.child_part_num = cp.part_num\nLEFT JOIN lego_db.lego_schema.parts pp ON pr.parent_part_num = pp.part_num", "relation_name": "lego_db.lego_schema.part_relationships"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-28T11:29:37.474662Z", "completed_at": "2024-05-28T11:29:37.493651Z"}, {"name": "execute", "started_at": "2024-05-28T11:29:37.499646Z", "completed_at": "2024-05-28T11:29:39.734294Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 2.5115013122558594, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01b4a111-0000-b8e4-0000-a039000387a2"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.dbtLego.sets_revenue", "compiled": true, "compiled_code": "-- models/transformation/sets_revenue.sql\nSELECT\n    i.inventory_id,\n    i.set_num,\n    s.name AS set_name,\n    s.num_parts,\n    i.quantity,\n    s.num_parts * i.quantity AS total_parts,\n    (s.num_parts * i.quantity) * 0.1 AS estimated_revenue -- Assuming $0.1 per part\nFROM lego_db.lego_schema.inventory_sets i\nJOIN lego_db.lego_schema.sets s ON i.set_num = s.set_num", "relation_name": "lego_db.lego_schema.sets_revenue"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-28T11:29:37.750507Z", "completed_at": "2024-05-28T11:29:37.762499Z"}, {"name": "execute", "started_at": "2024-05-28T11:29:37.764496Z", "completed_at": "2024-05-28T11:29:40.372132Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 2.8590292930603027, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01b4a111-0000-b8e4-0000-a039000387a6"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.dbtLego.top_selling_sets_by_year", "compiled": true, "compiled_code": "-- models/analysis/top_selling_sets_by_year.sql\nSELECT\n    s.year,\n    s.set_num,\n    s.name,\n    SUM(i.quantity) AS total_quantity_sold\nFROM lego_db.lego_schema.inventory_sets i\nJOIN lego_db.lego_schema.sets s ON i.set_num = s.set_num\nGROUP BY s.year, s.set_num, s.name\nORDER BY s.year, total_quantity_sold DESC", "relation_name": "lego_db.lego_schema.top_selling_sets_by_year"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-28T11:29:34.287798Z", "completed_at": "2024-05-28T11:29:34.321779Z"}, {"name": "execute", "started_at": "2024-05-28T11:29:34.353761Z", "completed_at": "2024-05-28T11:29:41.262524Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 7.206048965454102, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01b4a111-0000-b8e4-0000-a0390003879a"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.dbtLego.inventory_parts", "compiled": true, "compiled_code": "SELECT\n    ip.inventory_id,\n    ip.part_num,\n    ip.color_id,\n    ip.quantity,\n    ip.is_spare,\n    ip.img_url,\n    p.name AS part_name,\n    c.name AS color_name\nFROM lego_db.lego_schema.inventory_parts ip\nLEFT JOIN lego_db.lego_schema.parts p ON ip.part_num = p.part_num\nLEFT JOIN lego_db.lego_schema.colors c ON ip.color_id = c.id", "relation_name": "lego_db.lego_schema.inventory_parts"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-28T11:29:39.736298Z", "completed_at": "2024-05-28T11:29:39.756282Z"}, {"name": "execute", "started_at": "2024-05-28T11:29:39.759280Z", "completed_at": "2024-05-28T11:29:42.057978Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 2.7157442569732666, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01b4a111-0000-b8c5-0000-a0390003b112"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.dbtLego.total_sets_per_inventory", "compiled": true, "compiled_code": "-- models/aggregations/total_sets_per_inventory.sql\nSELECT\n    inventory_id,\n    SUM(quantity) AS total_sets\nFROM lego_db.lego_schema.inventory_sets\nGROUP BY inventory_id", "relation_name": "lego_db.lego_schema.total_sets_per_inventory"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-28T11:29:40.004157Z", "completed_at": "2024-05-28T11:29:40.017152Z"}, {"name": "execute", "started_at": "2024-05-28T11:29:40.019149Z", "completed_at": "2024-05-28T11:29:42.607820Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 2.859299421310425, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01b4a111-0000-b92c-0000-a0390003c082"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.dbtLego.parts_with_multiple_colors", "compiled": true, "compiled_code": "-- models/analysis/parts_with_multiple_colors.sql\n\nSELECT\n    p.part_num,\n    p.name,\n    COUNT(DISTINCT e.color_id) AS color_count\nFROM\n    lego_db.lego_schema.parts AS p\nJOIN\n    lego_db.lego_schema.elements AS e ON p.part_num = e.part_num\nGROUP BY\n    p.part_num,\n    p.name\nORDER BY\n    color_count DESC\nLIMIT 10", "relation_name": "lego_db.lego_schema.parts_with_multiple_colors"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-28T11:29:40.669497Z", "completed_at": "2024-05-28T11:29:40.684489Z"}, {"name": "execute", "started_at": "2024-05-28T11:29:40.686487Z", "completed_at": "2024-05-28T11:29:43.152386Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 2.7017605304718018, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01b4a111-0000-b8e4-0000-a039000387aa"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.dbtLego.parent_child_part_relationships", "compiled": true, "compiled_code": "-- models/analysis/parent_child_part_relationships.sql\n\nSELECT\n    pr.parent_part_num,\n    p1.name AS parent_name,\n    pr.child_part_num,\n    p2.name AS child_name\nFROM\n    lego_db.lego_schema.part_relationships AS pr\nJOIN\n    lego_db.lego_schema.parts AS p1 ON pr.parent_part_num = p1.part_num\nJOIN\n    lego_db.lego_schema.parts AS p2 ON pr.child_part_num = p2.part_num\nORDER BY\n    pr.parent_part_num,\n    pr.child_part_num", "relation_name": "lego_db.lego_schema.parent_child_part_relationships"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-28T11:29:42.562103Z", "completed_at": "2024-05-28T11:29:42.610823Z"}, {"name": "execute", "started_at": "2024-05-28T11:29:42.618823Z", "completed_at": "2024-05-28T11:29:45.355709Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 3.0949273109436035, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01b4a111-0000-b8e4-0000-a039000387ae"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.dbtLego.total_revenue", "compiled": true, "compiled_code": "-- models/transformation/total_revenue.sql\nSELECT\n    SUM(estimated_revenue) AS total_revenue\nFROM lego_db.lego_schema.sets_revenue", "relation_name": "lego_db.lego_schema.total_revenue"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-28T11:29:42.585826Z", "completed_at": "2024-05-28T11:29:42.631805Z"}, {"name": "execute", "started_at": "2024-05-28T11:29:42.645349Z", "completed_at": "2024-05-28T11:29:45.367706Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 3.0899271965026855, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01b4a111-0000-b92c-0000-a0390003c086"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.dbtLego.most_common_colors", "compiled": true, "compiled_code": "-- models/analysis/most_common_colors.sql\n\nSELECT\n    c.name AS color_name,\n    COUNT(*) AS part_count\nFROM\n    lego_db.lego_schema.inventory_parts AS ip\nJOIN\n    lego_db.lego_schema.colors AS c ON ip.color_id = c.id\nGROUP BY\n    c.name\nORDER BY\n    part_count DESC\nLIMIT 10", "relation_name": "lego_db.lego_schema.most_common_colors"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-28T11:29:42.878448Z", "completed_at": "2024-05-28T11:29:42.891441Z"}, {"name": "execute", "started_at": "2024-05-28T11:29:42.893440Z", "completed_at": "2024-05-28T11:29:45.567172Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 2.921532154083252, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01b4a111-0000-b92c-0000-a0390003c08a"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.dbtLego.most_common_part_category_per_inventory", "compiled": true, "compiled_code": "-- models/aggregations/most_common_part_category_per_inventory.sql\nWITH part_counts AS (\n    SELECT\n        ip.inventory_id,\n        p.part_cat_id,\n        COUNT(*) AS part_category_count\n    FROM lego_db.lego_schema.inventory_parts ip\n    JOIN lego_db.lego_schema.parts p ON ip.part_num = p.part_num\n    GROUP BY ip.inventory_id, p.part_cat_id\n),\nranked_part_categories AS (\n    SELECT\n        inventory_id,\n        part_cat_id,\n        part_category_count,\n        RANK() OVER (PARTITION BY inventory_id ORDER BY part_category_count DESC) AS category_rank\n    FROM part_counts\n)\nSELECT\n    inventory_id,\n    part_cat_id,\n    part_category_count\nFROM ranked_part_categories\nWHERE category_rank = 1", "relation_name": "lego_db.lego_schema.most_common_part_category_per_inventory"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-28T11:29:43.415580Z", "completed_at": "2024-05-28T11:29:43.431572Z"}, {"name": "execute", "started_at": "2024-05-28T11:29:43.433571Z", "completed_at": "2024-05-28T11:29:45.825986Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 2.6502468585968018, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01b4a111-0000-b8c5-0000-a0390003b116"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.dbtLego.most_common_parts", "compiled": true, "compiled_code": "-- models/analysis/most_common_parts.sql\n\nSELECT\n    ip.part_num,\n    p.name,\n    SUM(ip.quantity) AS total_quantity\nFROM\n    lego_db.lego_schema.inventory_parts AS ip\nJOIN\n    lego_db.lego_schema.parts AS p ON ip.part_num = p.part_num\nGROUP BY\n    ip.part_num,\n    p.name\nORDER BY\n    total_quantity DESC\nLIMIT 10", "relation_name": "lego_db.lego_schema.most_common_parts"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-28T11:29:45.721993Z", "completed_at": "2024-05-28T11:29:45.741979Z"}, {"name": "execute", "started_at": "2024-05-28T11:29:45.743980Z", "completed_at": "2024-05-28T11:29:48.031566Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 2.559082508087158, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01b4a111-0000-b92c-0000-a0390003c092"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.dbtLego.total_spare_quantity_per_inventory", "compiled": true, "compiled_code": "-- models/aggregations/total_spare_quantity_per_inventory.sql\nSELECT\n    inventory_id,\n    SUM(CASE WHEN is_spare THEN quantity ELSE 0 END) AS total_spare_quantity\nFROM lego_db.lego_schema.inventory_parts\nGROUP BY inventory_id", "relation_name": "lego_db.lego_schema.total_spare_quantity_per_inventory"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-28T11:29:45.703000Z", "completed_at": "2024-05-28T11:29:45.731983Z"}, {"name": "execute", "started_at": "2024-05-28T11:29:45.733983Z", "completed_at": "2024-05-28T11:29:48.078539Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 2.6150364875793457, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01b4a111-0000-b92c-0000-a0390003c08e"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.dbtLego.total_quantity_per_part", "compiled": true, "compiled_code": "-- models/aggregations/total_quantity_per_part.sql\nSELECT\n    part_num,\n    SUM(quantity) AS total_quantity\nFROM lego_db.lego_schema.inventory_parts\nGROUP BY part_num", "relation_name": "lego_db.lego_schema.total_quantity_per_part"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-28T11:29:45.807979Z", "completed_at": "2024-05-28T11:29:45.813974Z"}, {"name": "execute", "started_at": "2024-05-28T11:29:45.814974Z", "completed_at": "2024-05-28T11:29:48.512631Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 2.958139419555664, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01b4a111-0000-b92c-0000-a0390003c096"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.dbtLego.unique_parts_count_per_inventory", "compiled": true, "compiled_code": "-- models/aggregations/unique_parts_count_per_inventory.sql\nSELECT\n    inventory_id,\n    COUNT(DISTINCT part_num) AS unique_parts_count\nFROM lego_db.lego_schema.inventory_parts\nGROUP BY inventory_id", "relation_name": "lego_db.lego_schema.unique_parts_count_per_inventory"}], "elapsed_time": 34.4496750831604, "args": {"use_colors": true, "empty": false, "which": "run", "enable_legacy_logger": false, "select": [], "log_format": "default", "vars": {}, "defer": false, "log_level": "info", "cache_selected_only": false, "version_check": true, "warn_error_options": {"include": [], "exclude": []}, "profiles_dir": "C:\\Users\\MohammedMecheter\\DataspellProjects\\dbtLego", "write_json": true, "exclude": [], "source_freshness_run_project_hooks": false, "macro_debugging": false, "partial_parse": true, "printer_width": 80, "favor_state": false, "show_resource_report": false, "project_dir": "C:\\Users\\MohammedMecheter\\DataspellProjects\\dbtLego", "indirect_selection": "eager", "log_file_max_bytes": 10485760, "populate_cache": true, "strict_mode": false, "log_format_file": "debug", "log_path": "C:\\Users\\MohammedMecheter\\DataspellProjects\\dbtLego\\logs", "send_anonymous_usage_stats": true, "quiet": false, "invocation_command": "dbt run", "log_level_file": "debug", "use_colors_file": true, "partial_parse_file_diff": true, "print": true, "require_explicit_package_overrides_for_builtin_materializations": true, "require_resource_names_without_spaces": false, "static_parser": true, "introspect": true}}